---
title: Heyting Implication in a Frame
author: Ayberk Tosun (j.w.w. Mart√≠n Escard√≥)
---

<!--
```agda
{-# OPTIONS --cubical --safe #-}

open import Basis
open import Poset
open import Frame
open import Spectral
open import Nucleus

module HeytingImplication where
```
-->

## Basis

Given a (ùì§, ùì•, ùì¶)-frame F, we say that some ùì¶-family on ‚à£ F ‚à£ forms a basis for
it iff for every x : ‚à£ F ‚à£, there exists a family U of basic elements such that
‚ãÅ U is the join of x.

```agda
formsBasis : (F : Frame ùì§ ùì• ùì¶) ‚Üí Fam ùì¶ ‚à£ F ‚à£F ‚Üí (ùì§ ‚à® ùì• ‚à® ùì¶ ‚Å∫) Ãá
formsBasis {ùì• = ùì•} {ùì¶} F B =
  ((x : ‚à£ F ‚à£F) ‚Üí
     Œ£[ U ‚àà Fam ùì¶ (index B) ]
       [ isDirected (pos F) ‚ÅÖ B $ u ‚à£ u Œµ U ‚ÅÜ ‚äì isSup (pos F) ‚ÅÖ B $ u ‚à£ u Œµ U ‚ÅÜ x ])

-- F has a compact basis iff there is some ùì¶-family B s.t.
--
--   1. what I now have in `formsBasis`,
--   2. the compact elements form a meet-sublattice.

hasBasis : (F : Frame ùì§ ùì• ùì¶) ‚Üí (ùì§ ‚à® ùì• ‚à® ùì¶ ‚Å∫) Ãá
hasBasis {ùì¶ = ùì¶} F = Œ£[ B ‚àà Fam ùì¶ ‚à£ F ‚à£F ] formsBasis F B
```

## Definition of Heyting implication

```agda
module DefnOfHeytingImplication (F : Frame ùì§ ùì• ùì¶) where
```

We say that some z is the Heyting implication for (x, y) iff for every w, w ‚â§ z
iff (w ‚àß x) ‚â§ y.

```agda
  _isHeytingImplicationFor_ : ‚à£ F ‚à£F ‚Üí ‚à£ F ‚à£F √ó ‚à£ F ‚à£F ‚Üí hProp (ùì§ ‚à® ùì•)
  z isHeytingImplicationFor (x , y) =
    ‚àÄ[ w ‚à∂ ‚à£ F ‚à£F ] (w ‚äë[ pos F ] z) ‚áî ((x ‚äì[ F ] w) ‚äë[ pos F ] y)
```

Given a binary operation on the frame, we say that it is a Heyting implication
iff it gives the Heyting implication for any two opens.

```agda
  isHeytingImplication : (‚à£ F ‚à£F ‚Üí ‚à£ F ‚à£F ‚Üí ‚à£ F ‚à£F) ‚Üí hProp (ùì§ ‚à® ùì•)
  isHeytingImplication _‚áí_ =
    ‚àÄ[ x ‚à∂ ‚à£ F ‚à£F ] ‚àÄ[ y ‚à∂ ‚à£ F ‚à£F ]
      ((x ‚áí y) isHeytingImplicationFor (x , y))
```

```agda
module HeytingImplicationProperties (F : Frame ùì§ ùì• ùì¶) where

  open DefnOfHeytingImplication F

  lemma‚ÇÄ : {x y z u v w : ‚à£ F ‚à£F}
      ‚Üí [ u isHeytingImplicationFor (x , (y ‚äì[ F ] z)) ]
      ‚Üí [ v isHeytingImplicationFor (x , y) ]
      ‚Üí [ w isHeytingImplicationFor (x , z) ]
      ‚Üí u ‚â° v ‚äì[ F ] w
  lemma‚ÇÄ {x} {y} {z} {u} {v} {w} p q r = ‚äì-unique F v w u Œ≤‚ÇÄ Œ≤‚ÇÅ Œ≥
    where
    open PosetReasoning (pos F)

    Œ¥‚ÇÄ : [ (x ‚äì[ F ] u) ‚äë[ pos F ] y ]
    Œ¥‚ÇÄ = x ‚äì[ F ] u ‚äë‚ü® œÄ‚ÇÄ (p u) (‚äë[ pos F ]-refl u) ‚ü©
         y ‚äì[ F ] z ‚äë‚ü® ‚äì[ F ]-lower‚ÇÄ y z            ‚ü©
         y          ‚ñ†

    Œ¥‚ÇÅ : [ (x ‚äì[ F ] u) ‚äë[ pos F ] z ]
    Œ¥‚ÇÅ = x ‚äì[ F ] u ‚äë‚ü® œÄ‚ÇÄ (p u) (‚äë[ pos F ]-refl u) ‚ü©
         y ‚äì[ F ] z ‚äë‚ü® ‚äì[ F ]-lower‚ÇÅ y z            ‚ü©
         z          ‚ñ†

    Œ≤‚ÇÄ : [ u ‚äë[ pos F ] v ]
    Œ≤‚ÇÄ = œÄ‚ÇÅ (q u) Œ¥‚ÇÄ

    Œ≤‚ÇÅ : [ u ‚äë[ pos F ] w ]
    Œ≤‚ÇÅ = œÄ‚ÇÅ (r u) Œ¥‚ÇÅ

    Œ≥ : (t : ‚à£ F ‚à£F)
      ‚Üí [ t ‚äë[ pos F ] v ] ‚Üí [ t ‚äë[ pos F ] w ] ‚Üí [ t ‚äë[ pos F ] u ]
    Œ≥ t œï œà = œÄ‚ÇÅ (p t) ((‚äì[ F ]-greatest y z (x ‚äì[ F ] t) Œµ) Œ∂)
      where
      Œµ : [ x ‚äì[ F ] t ‚äë[ pos F ] y ]
      Œµ = x ‚äì[ F ] t     ‚äë‚ü® cright F x œï                 ‚ü©
          x ‚äì[ F ] v     ‚äë‚ü® œÄ‚ÇÄ (q v) (‚äë[ pos F ]-refl v) ‚ü©
          y              ‚ñ†

      Œ∂ : [ (x ‚äì[ F ] t) ‚äë[ pos F ] z ]
      Œ∂ = x ‚äì[ F ] t     ‚äë‚ü® cright F x œà                 ‚ü©
          x ‚äì[ F ] w     ‚äë‚ü® œÄ‚ÇÄ (r w) (‚äë[ pos F ]-refl w) ‚ü©
          z              ‚ñ†
```

## Construction of the Heyting implication

```agda
module Definition (F : Frame ùì§ ùì• ùì•) (basis : hasBasis F) where
```

```agda
  open DefnOfHeytingImplication F

  _‚â§_ : ‚à£ F ‚à£F ‚Üí ‚à£ F ‚à£F ‚Üí hProp ùì•
  x ‚â§ y = x ‚äë[ pos F ] y

  infix 3 _‚â§_

  _‚àß_ : ‚à£ F ‚à£F ‚Üí ‚à£ F ‚à£F ‚Üí ‚à£ F ‚à£F
  x ‚àß y = x ‚äì[ F ] y

  ‚Ñ¨ : ùì• Ãá
  ‚Ñ¨ = œÄ‚ÇÄ (œÄ‚ÇÄ basis)

  Œ≤ : ‚Ñ¨ ‚Üí ‚à£ F ‚à£F
  Œ≤ = œÄ‚ÇÅ (œÄ‚ÇÄ basis)
```

We define the implication as follows:

```agda
  _==>_ : ‚à£ F ‚à£F ‚Üí ‚à£ F ‚à£F ‚Üí ‚à£ F ‚à£F
  x ==> y =
    ‚ãÅ[ F ] ‚ÅÖ Œ≤ b ‚à£ (b , _) ‚à∂ Œ£[ b ‚àà ‚Ñ¨ ] [ (x ‚àß Œ≤ b) ‚â§ y ] ‚ÅÜ
```

Of course, the first thing we prove is modus ponens:

```agda
  mp : (x y : ‚à£ F ‚à£F) ‚Üí [ x ‚äì[ F ] (x ==> y) ‚äë[ pos F ] y ]
  mp x y =
    x ‚äì[ F ] (x ==> y)                    ‚äë‚ü® ‚â°‚áí‚äë (pos F ) (dist F _ _) ‚ü©
    ‚ãÅ[ F ] ‚ÅÖ x ‚äì[ F ] Œ≤ b ‚à£ (b , _) ‚à∂ _ ‚ÅÜ ‚äë‚ü® ‚ãÅ[ F ]-least _ _ Œ≥        ‚ü©
    y                                     ‚ñ†
    where
    open PosetReasoning (pos F)

    Œ≥ : _
    Œ≥ z ((_ , q) , eq) = subst (Œª - ‚Üí [ - ‚äë[ pos F ] _ ]) eq q

  mp-op : (x y : ‚à£ F ‚à£F) ‚Üí [ (x ==> y) ‚äì[ F ] x ‚äë[ pos F ] y ]
  mp-op x y = (x ==> y) ‚äì[ F ] x ‚äë‚ü® ‚â°‚áí‚äë (pos F) (comm F (x ==> y) x) ‚ü©
              x ‚äì[ F ] (x ==> y) ‚äë‚ü® mp x y                           ‚ü©
              y                  ‚ñ†
    where
    open PosetReasoning (pos F)
```

We now proceed to prove that this is the Heyting implication:

```agda
  lemma : (x y : ‚à£ F ‚à£F) (c : ‚Ñ¨)
        ‚Üí [ (x ‚àß Œ≤ c ‚â§ y) ‚áí (Œ≤ c ‚â§ x ==> y) ]
  lemma x y c p = ‚ãÅ[ F ]-upper _ (Œ≤ c) ((c , p) , refl)

  ==>-is-HI : [ isHeytingImplication _==>_ ]
  ==>-is-HI x y z = forward , backward
    where
    open PosetReasoning (pos F)

    forward : [ (z ‚â§ x ==> y) ‚áí (x ‚àß z ‚â§ y) ]
    forward p = x ‚äì[ F ] z         ‚äë‚ü® cright F _ p ‚ü©
                x ‚äì[ F ] (x ==> y) ‚äë‚ü® mp x y       ‚ü©
                y                  ‚ñ†

    backward : [ ((x ‚àß z) ‚â§ y) ‚áí (z ‚â§ x ==> y) ]
    backward p = z                       ‚äë‚ü® ‚â°‚áí‚äë (pos F) Œµ        ‚ü©
                 ‚ãÅ[ F ] ‚ÅÖ Œ≤ v ‚à£ v Œµ VV ‚ÅÜ ‚äë‚ü® ‚ãÅ[ F ]-least _ _ nts ‚ü©
                 x ==> y                 ‚ñ†
      where
      VV : Fam ùì• ‚Ñ¨
      VV = œÄ‚ÇÄ (œÄ‚ÇÅ basis z)

      Œµ : z ‚â° ‚ãÅ[ F ] ‚ÅÖ Œ≤ v ‚à£ v Œµ VV ‚ÅÜ
      Œµ = ‚ãÅ-unique F ‚ÅÖ Œ≤ v ‚à£ v Œµ VV ‚ÅÜ _ (œÄ‚ÇÄ lub) (œÄ‚ÇÅ lub)
        where
        lub = œÄ‚ÇÅ (œÄ‚ÇÅ (œÄ‚ÇÅ basis z))

      nts : _
      nts w (i , eq) = w          ‚äë‚ü® ‚â°‚áí‚äë (pos F) (sym eq)                              ‚ü©
                       Œ≤ (VV $ i) ‚äë‚ü® ‚ãÅ[ F ]-upper _ (Œ≤ (VV $ i)) ((VV $ i , Œ¥) , refl) ‚ü©
                       x ==> y    ‚ñ†
        where
        Œ¥ : [ x ‚äì[ F ] Œ≤ (VV $ i) ‚â§ y ]
        Œ¥ = x ‚àß Œ≤ (VV $ i)                ‚äë‚ü® cright F _ (‚ãÅ[ F ]-upper _ _ (i , refl)) ‚ü©
            x ‚àß (‚ãÅ[ F ] ‚ÅÖ Œ≤ v ‚à£ v Œµ VV ‚ÅÜ) ‚äë‚ü® cright F _ (‚â°‚áí‚äë (pos F) (sym Œµ))         ‚ü©
            x ‚àß z                         ‚äë‚ü® p                                        ‚ü©
            y                             ‚ñ†

  ==>-id : (x : ‚à£ F ‚à£F) ‚Üí x ==> x ‚â° ‚ä§[ F ]
  ==>-id x = ‚äë[ pos F ]-antisym (x ==> x) ‚ä§[ F ] (‚ä§[ F ]-top (x ==> x)) Gùüê
    where
    Gùüê : [ ‚ä§[ F ] ‚äë[ pos F ] (x ==> x) ]
    Gùüê = œÄ‚ÇÅ (==>-is-HI x x ‚ä§[ F ]) (‚äì[ F ]-lower‚ÇÄ x ‚ä§[ F ])

  ==>-nucleus-lemma : (x y : ‚à£ F ‚à£F) (j : Nucleus F)
                    ‚Üí [ (x ==> y) ‚äë[ pos F ] (œÄ‚ÇÄ j x ==> œÄ‚ÇÄ j y) ]
  ==>-nucleus-lemma x y ùíø@(j , ùìÉ‚ÇÄ , ùìÉ‚ÇÅ , ùìÉ‚ÇÇ) =
    (x ==> y)      ‚äë‚ü® ‚¶Öùüè‚¶Ü ‚ü©
    (x ==> j y)    ‚äë‚ü® ‚¶Öùüê‚¶Ü ‚ü©
    (j x ==> j y)  ‚ñ†
    where
    open PosetReasoning (pos F)

    ‚¶Öùüè‚¶Ü : [ (x ==> y) ‚äë[ pos F ] (x ==> j y) ]
    ‚¶Öùüè‚¶Ü = œÄ‚ÇÅ (==>-is-HI x (j y) (x ==> y)) (_ ‚äë‚ü® mp x y ‚ü© y ‚äë‚ü® ùìÉ‚ÇÅ y ‚ü© j y ‚ñ†)

    ‚¶Öùüê‚¶Ü : [ (x ==> j y) ‚äë[ pos F ] (j x ==> j y) ]
    ‚¶Öùüê‚¶Ü = œÄ‚ÇÅ (==>-is-HI (j x) (j y) (x ==> j y)) ‚¶Öùüêa‚¶Ü
      where
      ‚¶Öùüêa‚¶Ü : [ j x ‚äì[ F ] (x ==> j y) ‚äë[ pos F ] (j y) ]
      ‚¶Öùüêa‚¶Ü =
        j x ‚äì[ F ] (x ==> j y)   ‚äë‚ü® cright F (j x) (ùìÉ‚ÇÅ (x ==> j y))      ‚ü©
        j x ‚äì[ F ] j (x ==> j y) ‚äë‚ü® ‚â°‚áí‚äë (pos F) (sym (ùìÉ‚ÇÄ x (x ==> j y))) ‚ü©
        j (x ‚äì[ F ] (x ==> j y)) ‚äë‚ü® mono F ùíø _ _ (mp x (j y))            ‚ü©
        j (j y)                  ‚äë‚ü® ùìÉ‚ÇÇ y                                 ‚ü©
        j y                      ‚ñ†

  ‚à®-cright : (x y z : ‚à£ F ‚à£F)
           ‚Üí [ y ‚äë[ pos F ] z ] ‚Üí [ (x ‚à®[ F ] y) ‚äë[ pos F ] (x ‚à®[ F ] z) ]
  ‚à®-cright x y z p = ‚ãÅ[ F ]-least _ _ nts
    where
    open PosetReasoning (pos F)

    nts : _
    nts w (true  , eq) =
      w ‚äë‚ü® ‚â°‚áí‚äë (pos F) (sym eq) ‚ü© x ‚äë‚ü® ‚äî[ F ]-upper‚ÇÄ x z ‚ü© x ‚à®[ F ] z ‚ñ†
    nts w (false , eq) =
      w ‚äë‚ü® ‚â°‚áí‚äë (pos F) (sym eq) ‚ü© y ‚äë‚ü® p ‚ü©  z ‚äë‚ü® ‚äî[ F ]-upper‚ÇÅ x z ‚ü© x ‚à®[ F ] z ‚ñ†

  ‚à®-cleft : (x y z : ‚à£ F ‚à£F)
          ‚Üí [ x ‚äë[ pos F ] y ] ‚Üí [ (x ‚à®[ F ] z) ‚äë[ pos F ] (y ‚à®[ F ] z)  ]
  ‚à®-cleft x y z p = ‚ãÅ[ F ]-least _ _ nts
    where
    open PosetReasoning (pos F)

    nts : _
    nts w (true  , eq) = w            ‚äë‚ü® ‚â°‚áí‚äë (pos F) (sym eq) ‚ü©
                         x            ‚äë‚ü® p                    ‚ü©
                         y            ‚äë‚ü® ‚äî[ F ]-upper‚ÇÄ y z    ‚ü©
                         y ‚à®[ F ] z   ‚ñ†
    nts w (false , eq) = w ‚äë‚ü® ‚â°‚áí‚äë (pos F) (sym eq) ‚ü© z ‚äë‚ü® ‚äî[ F ]-upper‚ÇÅ y z ‚ü© y ‚à®[ F ] z ‚ñ†

  ==>-‚à®-lemma : (x y z : ‚à£ F ‚à£F)
              ‚Üí [ ((x ==> z) ‚äì[ F ] (y ==> z)) ‚äë[ pos F ] ((x ‚à®[ F ] y) ==> z) ]
  ==>-‚à®-lemma x y z = œÄ‚ÇÅ (==>-is-HI _ _ _) Gùüè
    where
    open PosetReasoning (pos F)

    Gùüè : [ (x ‚à®[ F ] y) ‚äì[ F ] ((x ==> z) ‚äì[ F ] (y ==> z)) ‚äë[ pos F ] z ]
    Gùüè = (x ‚à®[ F ] y) ‚äì[ F ] ((x ==> z) ‚äì[ F ] (y ==> z))   ‚äë‚ü® ‚â°‚áí‚äë (pos F) (comm F _ _) ‚ü©
         ((x ==> z) ‚äì[ F ] (y ==> z)) ‚äì[ F ](x ‚à®[ F ] y)    ‚äë‚ü® ‚â°‚áí‚äë (pos F) (bin-dist F ((x ==> z) ‚äì[ F ] (y ==> z)) x y)  ‚ü©
         (((x ==> z) ‚äì[ F ] (y ==> z)) ‚äì[ F ] x) ‚à®[ F ] (((x ==> z) ‚äì[ F ] (y ==> z)) ‚äì[ F ] y) ‚äë‚ü® ‚¶Öùüè‚¶Ü ‚ü©
         ((x ==> z) ‚äì[ F ] x) ‚à®[ F ] (((x ==> z) ‚äì[ F ] (y ==> z)) ‚äì[ F ] y) ‚äë‚ü® ‚¶Öùüê‚¶Ü ‚ü©
         ((x ==> z) ‚äì[ F ] x) ‚à®[ F ] ((y ==> z) ‚äì[ F ] y) ‚äë‚ü® ‚à®-cright _ _ _ (‚â°‚áí‚äë (pos F) (comm F (y ==> z) y)) ‚ü©
         ((x ==> z) ‚äì[ F ] x) ‚à®[ F ] (y ‚äì[ F ] (y ==> z)) ‚äë‚ü® ‚à®-cright _ _ _ (mp y z) ‚ü©
         ((x ==> z) ‚äì[ F ] x) ‚à®[ F ] z                    ‚äë‚ü® ‚à®-cleft _ _ _ (‚â°‚áí‚äë (pos F) (comm F _ _)) ‚ü©
         (x ‚äì[ F ] (x ==> z)) ‚à®[ F ] z                    ‚äë‚ü® ‚à®-cleft _ _ _ (mp x z) ‚ü©
         z ‚à®[ F ] z                                       ‚äë‚ü® ‚â°‚áí‚äë (pos F) (x‚à®x=x F z) ‚ü©
         z                                                ‚ñ†
      where
      Gùüê = ‚à®-cright z _ _ (mp y z)

      ‚¶Öùüè‚¶Ü = ‚à®-cleft _ _ _ (cleft F _ (‚äì[ F ]-lower‚ÇÄ _ _))

      ‚¶Öùüê‚¶Ü : _
      ‚¶Öùüê‚¶Ü = ‚à®-cright _ _ _ (cleft F _ (‚äì[ F ]-lower‚ÇÅ _ _))
```
