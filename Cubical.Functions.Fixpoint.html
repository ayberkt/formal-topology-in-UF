<a id="1" class="Comment">{-
  Definition of function fixpoint and Kraus&#39; lemma
-}</a>
<a id="58" class="Symbol">{-#</a> <a id="62" class="Keyword">OPTIONS</a> <a id="70" class="Pragma">--cubical</a> <a id="80" class="Pragma">--no-import-sorts</a> <a id="98" class="Pragma">--safe</a> <a id="105" class="Symbol">#-}</a>
<a id="109" class="Keyword">module</a> <a id="116" href="Cubical.Functions.Fixpoint.html" class="Module">Cubical.Functions.Fixpoint</a> <a id="143" class="Keyword">where</a>

<a id="150" class="Keyword">open</a> <a id="155" class="Keyword">import</a> <a id="162" href="Cubical.Foundations.Prelude.html" class="Module">Cubical.Foundations.Prelude</a>
<a id="190" class="Keyword">open</a> <a id="195" class="Keyword">import</a> <a id="202" href="Cubical.Foundations.Function.html" class="Module">Cubical.Foundations.Function</a>
<a id="231" class="Keyword">open</a> <a id="236" class="Keyword">import</a> <a id="243" href="Cubical.Foundations.GroupoidLaws.html" class="Module">Cubical.Foundations.GroupoidLaws</a>
<a id="276" class="Keyword">open</a> <a id="281" class="Keyword">import</a> <a id="288" href="Cubical.Foundations.Path.html" class="Module">Cubical.Foundations.Path</a>

<a id="314" class="Keyword">private</a>
  <a id="324" class="Keyword">variable</a>
    <a id="337" href="Cubical.Functions.Fixpoint.html#337" class="Generalizable">ℓ</a> <a id="339" class="Symbol">:</a> <a id="341" href="Agda.Primitive.html#523" class="Postulate">Level</a>
    <a id="351" href="Cubical.Functions.Fixpoint.html#351" class="Generalizable">A</a> <a id="353" class="Symbol">:</a> <a id="355" href="Cubical.Core.Primitives.html#1230" class="Primitive">Type</a> <a id="360" href="Cubical.Functions.Fixpoint.html#337" class="Generalizable">ℓ</a>

<a id="Fixpoint"></a><a id="363" href="Cubical.Functions.Fixpoint.html#363" class="Function">Fixpoint</a> <a id="372" class="Symbol">:</a> <a id="374" class="Symbol">(</a><a id="375" href="Cubical.Functions.Fixpoint.html#351" class="Generalizable">A</a> <a id="377" class="Symbol">→</a> <a id="379" href="Cubical.Functions.Fixpoint.html#351" class="Generalizable">A</a><a id="380" class="Symbol">)</a> <a id="382" class="Symbol">→</a> <a id="384" href="Cubical.Core.Primitives.html#1230" class="Primitive">Type</a> <a id="389" class="Symbol">_</a>
<a id="391" href="Cubical.Functions.Fixpoint.html#363" class="Function">Fixpoint</a> <a id="400" class="Symbol">{</a><a id="401" class="Argument">A</a> <a id="403" class="Symbol">=</a> <a id="405" href="Cubical.Functions.Fixpoint.html#405" class="Bound">A</a><a id="406" class="Symbol">}</a> <a id="408" href="Cubical.Functions.Fixpoint.html#408" class="Bound">f</a> <a id="410" class="Symbol">=</a> <a id="412" href="Agda.Builtin.Sigma.html#166" class="Record">Σ</a> <a id="414" href="Cubical.Functions.Fixpoint.html#405" class="Bound">A</a> <a id="416" class="Symbol">(λ</a> <a id="419" href="Cubical.Functions.Fixpoint.html#419" class="Bound">x</a> <a id="421" class="Symbol">→</a> <a id="423" href="Cubical.Functions.Fixpoint.html#408" class="Bound">f</a> <a id="425" href="Cubical.Functions.Fixpoint.html#419" class="Bound">x</a> <a id="427" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="429" href="Cubical.Functions.Fixpoint.html#419" class="Bound">x</a><a id="430" class="Symbol">)</a>

<a id="fixpoint"></a><a id="433" href="Cubical.Functions.Fixpoint.html#433" class="Function">fixpoint</a> <a id="442" class="Symbol">:</a> <a id="444" class="Symbol">{</a><a id="445" href="Cubical.Functions.Fixpoint.html#445" class="Bound">f</a> <a id="447" class="Symbol">:</a> <a id="449" href="Cubical.Functions.Fixpoint.html#351" class="Generalizable">A</a> <a id="451" class="Symbol">→</a> <a id="453" href="Cubical.Functions.Fixpoint.html#351" class="Generalizable">A</a><a id="454" class="Symbol">}</a> <a id="456" class="Symbol">→</a> <a id="458" href="Cubical.Functions.Fixpoint.html#363" class="Function">Fixpoint</a> <a id="467" href="Cubical.Functions.Fixpoint.html#445" class="Bound">f</a> <a id="469" class="Symbol">→</a> <a id="471" href="Cubical.Functions.Fixpoint.html#351" class="Generalizable">A</a>
<a id="473" href="Cubical.Functions.Fixpoint.html#433" class="Function">fixpoint</a> <a id="482" class="Symbol">=</a> <a id="484" href="Agda.Builtin.Sigma.html#252" class="Field">fst</a>

<a id="fixpointPath"></a><a id="489" href="Cubical.Functions.Fixpoint.html#489" class="Function">fixpointPath</a> <a id="502" class="Symbol">:</a> <a id="504" class="Symbol">{</a><a id="505" href="Cubical.Functions.Fixpoint.html#505" class="Bound">f</a> <a id="507" class="Symbol">:</a> <a id="509" href="Cubical.Functions.Fixpoint.html#351" class="Generalizable">A</a> <a id="511" class="Symbol">→</a> <a id="513" href="Cubical.Functions.Fixpoint.html#351" class="Generalizable">A</a><a id="514" class="Symbol">}</a> <a id="516" class="Symbol">→</a> <a id="518" class="Symbol">(</a><a id="519" href="Cubical.Functions.Fixpoint.html#519" class="Bound">p</a> <a id="521" class="Symbol">:</a> <a id="523" href="Cubical.Functions.Fixpoint.html#363" class="Function">Fixpoint</a> <a id="532" href="Cubical.Functions.Fixpoint.html#505" class="Bound">f</a><a id="533" class="Symbol">)</a> <a id="535" class="Symbol">→</a> <a id="537" href="Cubical.Functions.Fixpoint.html#505" class="Bound">f</a> <a id="539" class="Symbol">(</a><a id="540" href="Cubical.Functions.Fixpoint.html#433" class="Function">fixpoint</a> <a id="549" href="Cubical.Functions.Fixpoint.html#519" class="Bound">p</a><a id="550" class="Symbol">)</a> <a id="552" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="554" href="Cubical.Functions.Fixpoint.html#433" class="Function">fixpoint</a> <a id="563" href="Cubical.Functions.Fixpoint.html#519" class="Bound">p</a>
<a id="565" href="Cubical.Functions.Fixpoint.html#489" class="Function">fixpointPath</a> <a id="578" class="Symbol">=</a> <a id="580" href="Agda.Builtin.Sigma.html#264" class="Field">snd</a>

<a id="585" class="Comment">-- Kraus&#39; lemma</a>
<a id="601" class="Comment">-- a version not using cubical features can be found at</a>
<a id="657" class="Comment">-- https://www.cs.bham.ac.uk/~mhe/GeneralizedHedberg/html/GeneralizedHedberg.html#21576</a>
<a id="2-Constant→isPropFixpoint"></a><a id="745" href="Cubical.Functions.Fixpoint.html#745" class="Function">2-Constant→isPropFixpoint</a> <a id="771" class="Symbol">:</a> <a id="773" class="Symbol">(</a><a id="774" href="Cubical.Functions.Fixpoint.html#774" class="Bound">f</a> <a id="776" class="Symbol">:</a> <a id="778" href="Cubical.Functions.Fixpoint.html#351" class="Generalizable">A</a> <a id="780" class="Symbol">→</a> <a id="782" href="Cubical.Functions.Fixpoint.html#351" class="Generalizable">A</a><a id="783" class="Symbol">)</a> <a id="785" class="Symbol">→</a> <a id="787" href="Cubical.Foundations.Function.html#1759" class="Function">2-Constant</a> <a id="798" href="Cubical.Functions.Fixpoint.html#774" class="Bound">f</a> <a id="800" class="Symbol">→</a> <a id="802" href="Cubical.Foundations.Prelude.html#9814" class="Function">isProp</a> <a id="809" class="Symbol">(</a><a id="810" href="Cubical.Functions.Fixpoint.html#363" class="Function">Fixpoint</a> <a id="819" href="Cubical.Functions.Fixpoint.html#774" class="Bound">f</a><a id="820" class="Symbol">)</a>
<a id="822" href="Cubical.Functions.Fixpoint.html#745" class="Function">2-Constant→isPropFixpoint</a> <a id="848" href="Cubical.Functions.Fixpoint.html#848" class="Bound">f</a> <a id="850" href="Cubical.Functions.Fixpoint.html#850" class="Bound">fconst</a> <a id="857" class="Symbol">(</a><a id="858" href="Cubical.Functions.Fixpoint.html#858" class="Bound">x</a> <a id="860" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="862" href="Cubical.Functions.Fixpoint.html#862" class="Bound">p</a><a id="863" class="Symbol">)</a> <a id="865" class="Symbol">(</a><a id="866" href="Cubical.Functions.Fixpoint.html#866" class="Bound">y</a> <a id="868" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="870" href="Cubical.Functions.Fixpoint.html#870" class="Bound">q</a><a id="871" class="Symbol">)</a> <a id="873" href="Cubical.Functions.Fixpoint.html#873" class="Bound">i</a> <a id="875" class="Symbol">=</a> <a id="877" href="Cubical.Functions.Fixpoint.html#1342" class="Function">s</a> <a id="879" href="Cubical.Functions.Fixpoint.html#873" class="Bound">i</a> <a id="881" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="883" href="Cubical.Functions.Fixpoint.html#1486" class="Function">t</a> <a id="885" href="Cubical.Functions.Fixpoint.html#873" class="Bound">i</a> <a id="887" class="Keyword">where</a>
  <a id="895" href="Cubical.Functions.Fixpoint.html#895" class="Function">noose</a> <a id="901" class="Symbol">:</a> <a id="903" class="Symbol">∀</a> <a id="905" href="Cubical.Functions.Fixpoint.html#905" class="Bound">x</a> <a id="907" href="Cubical.Functions.Fixpoint.html#907" class="Bound">y</a> <a id="909" class="Symbol">→</a> <a id="911" href="Cubical.Functions.Fixpoint.html#848" class="Bound">f</a> <a id="913" href="Cubical.Functions.Fixpoint.html#905" class="Bound">x</a> <a id="915" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="917" href="Cubical.Functions.Fixpoint.html#848" class="Bound">f</a> <a id="919" href="Cubical.Functions.Fixpoint.html#907" class="Bound">y</a>
  <a id="923" href="Cubical.Functions.Fixpoint.html#895" class="Function">noose</a> <a id="929" href="Cubical.Functions.Fixpoint.html#929" class="Bound">x</a> <a id="931" href="Cubical.Functions.Fixpoint.html#931" class="Bound">y</a> <a id="933" class="Symbol">=</a> <a id="935" href="Cubical.Foundations.Prelude.html#955" class="Function">sym</a> <a id="939" class="Symbol">(</a><a id="940" href="Cubical.Functions.Fixpoint.html#850" class="Bound">fconst</a> <a id="947" href="Cubical.Functions.Fixpoint.html#929" class="Bound">x</a> <a id="949" href="Cubical.Functions.Fixpoint.html#929" class="Bound">x</a><a id="950" class="Symbol">)</a> <a id="952" href="Cubical.Foundations.Prelude.html#3321" class="Function Operator">∙</a> <a id="954" href="Cubical.Functions.Fixpoint.html#850" class="Bound">fconst</a> <a id="961" href="Cubical.Functions.Fixpoint.html#929" class="Bound">x</a> <a id="963" href="Cubical.Functions.Fixpoint.html#931" class="Bound">y</a>
  <a id="967" class="Comment">-- the main idea is that for any path p, cong f p does not depend on p</a>
  <a id="1040" class="Comment">-- but only on its endpoints and the structure of 2-Constant f</a>
  <a id="1105" href="Cubical.Functions.Fixpoint.html#1105" class="Function">KrausInsight</a> <a id="1118" class="Symbol">:</a> <a id="1120" class="Symbol">∀</a> <a id="1122" class="Symbol">{</a><a id="1123" href="Cubical.Functions.Fixpoint.html#1123" class="Bound">x</a> <a id="1125" href="Cubical.Functions.Fixpoint.html#1125" class="Bound">y</a><a id="1126" class="Symbol">}</a> <a id="1128" class="Symbol">→</a> <a id="1130" class="Symbol">(</a><a id="1131" href="Cubical.Functions.Fixpoint.html#1131" class="Bound">p</a> <a id="1133" class="Symbol">:</a> <a id="1135" href="Cubical.Functions.Fixpoint.html#1123" class="Bound">x</a> <a id="1137" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="1139" href="Cubical.Functions.Fixpoint.html#1125" class="Bound">y</a><a id="1140" class="Symbol">)</a> <a id="1142" class="Symbol">→</a> <a id="1144" href="Cubical.Functions.Fixpoint.html#895" class="Function">noose</a> <a id="1150" href="Cubical.Functions.Fixpoint.html#1123" class="Bound">x</a> <a id="1152" href="Cubical.Functions.Fixpoint.html#1125" class="Bound">y</a> <a id="1154" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="1156" href="Cubical.Foundations.Prelude.html#1138" class="Function">cong</a> <a id="1161" href="Cubical.Functions.Fixpoint.html#848" class="Bound">f</a> <a id="1163" href="Cubical.Functions.Fixpoint.html#1131" class="Bound">p</a>
  <a id="1167" href="Cubical.Functions.Fixpoint.html#1105" class="Function">KrausInsight</a> <a id="1180" class="Symbol">{</a><a id="1181" href="Cubical.Functions.Fixpoint.html#1181" class="Bound">x</a><a id="1182" class="Symbol">}</a> <a id="1184" class="Symbol">=</a> <a id="1186" href="Cubical.Foundations.Prelude.html#8514" class="Function">J</a> <a id="1188" class="Symbol">(λ</a> <a id="1191" href="Cubical.Functions.Fixpoint.html#1191" class="Bound">y</a> <a id="1193" href="Cubical.Functions.Fixpoint.html#1193" class="Bound">p</a> <a id="1195" class="Symbol">→</a> <a id="1197" href="Cubical.Functions.Fixpoint.html#895" class="Function">noose</a> <a id="1203" href="Cubical.Functions.Fixpoint.html#1181" class="Bound">x</a> <a id="1205" href="Cubical.Functions.Fixpoint.html#1191" class="Bound">y</a> <a id="1207" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="1209" href="Cubical.Foundations.Prelude.html#1138" class="Function">cong</a> <a id="1214" href="Cubical.Functions.Fixpoint.html#848" class="Bound">f</a> <a id="1216" href="Cubical.Functions.Fixpoint.html#1193" class="Bound">p</a><a id="1217" class="Symbol">)</a> <a id="1219" class="Symbol">(</a><a id="1220" href="Cubical.Foundations.GroupoidLaws.html#2175" class="Function">lCancel</a> <a id="1228" class="Symbol">(</a><a id="1229" href="Cubical.Functions.Fixpoint.html#850" class="Bound">fconst</a> <a id="1236" href="Cubical.Functions.Fixpoint.html#1181" class="Bound">x</a> <a id="1238" href="Cubical.Functions.Fixpoint.html#1181" class="Bound">x</a><a id="1239" class="Symbol">))</a>
  <a id="1244" class="Comment">-- Need to solve for a path s : x ≡ y, such that:</a>
  <a id="1296" class="Comment">-- transport (λ i → cong f s i ≡ s i) p ≡ q</a>
  <a id="1342" href="Cubical.Functions.Fixpoint.html#1342" class="Function">s</a> <a id="1344" class="Symbol">:</a> <a id="1346" href="Cubical.Functions.Fixpoint.html#858" class="Bound">x</a> <a id="1348" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="1350" href="Cubical.Functions.Fixpoint.html#866" class="Bound">y</a>
  <a id="1354" href="Cubical.Functions.Fixpoint.html#1342" class="Function">s</a> <a id="1356" class="Symbol">=</a> <a id="1358" href="Cubical.Foundations.Prelude.html#955" class="Function">sym</a> <a id="1362" href="Cubical.Functions.Fixpoint.html#862" class="Bound">p</a> <a id="1364" href="Cubical.Foundations.Prelude.html#2119" class="Function Operator">∙∙</a> <a id="1367" href="Cubical.Functions.Fixpoint.html#895" class="Function">noose</a> <a id="1373" href="Cubical.Functions.Fixpoint.html#858" class="Bound">x</a> <a id="1375" href="Cubical.Functions.Fixpoint.html#866" class="Bound">y</a> <a id="1377" href="Cubical.Foundations.Prelude.html#2119" class="Function Operator">∙∙</a> <a id="1380" href="Cubical.Functions.Fixpoint.html#870" class="Bound">q</a>
  <a id="1384" href="Cubical.Functions.Fixpoint.html#1384" class="Function">t&#39;</a> <a id="1387" class="Symbol">:</a> <a id="1389" href="Agda.Builtin.Cubical.Path.html#190" class="Postulate">PathP</a> <a id="1395" class="Symbol">(λ</a> <a id="1398" href="Cubical.Functions.Fixpoint.html#1398" class="Bound">i</a> <a id="1400" class="Symbol">→</a> <a id="1402" href="Cubical.Functions.Fixpoint.html#895" class="Function">noose</a> <a id="1408" href="Cubical.Functions.Fixpoint.html#858" class="Bound">x</a> <a id="1410" href="Cubical.Functions.Fixpoint.html#866" class="Bound">y</a> <a id="1412" href="Cubical.Functions.Fixpoint.html#1398" class="Bound">i</a> <a id="1414" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="1416" href="Cubical.Functions.Fixpoint.html#1342" class="Function">s</a> <a id="1418" href="Cubical.Functions.Fixpoint.html#1398" class="Bound">i</a><a id="1419" class="Symbol">)</a> <a id="1421" href="Cubical.Functions.Fixpoint.html#862" class="Bound">p</a> <a id="1423" href="Cubical.Functions.Fixpoint.html#870" class="Bound">q</a>
  <a id="1427" href="Cubical.Functions.Fixpoint.html#1384" class="Function">t&#39;</a> <a id="1430" href="Cubical.Functions.Fixpoint.html#1430" class="Bound">i</a> <a id="1432" href="Cubical.Functions.Fixpoint.html#1432" class="Bound">j</a> <a id="1434" class="Symbol">=</a> <a id="1436" href="Cubical.Foundations.Prelude.html#2217" class="Function">doubleCompPath-filler</a> <a id="1458" class="Symbol">(</a><a id="1459" href="Cubical.Foundations.Prelude.html#955" class="Function">sym</a> <a id="1463" href="Cubical.Functions.Fixpoint.html#862" class="Bound">p</a><a id="1464" class="Symbol">)</a> <a id="1466" class="Symbol">(</a><a id="1467" href="Cubical.Functions.Fixpoint.html#895" class="Function">noose</a> <a id="1473" href="Cubical.Functions.Fixpoint.html#858" class="Bound">x</a> <a id="1475" href="Cubical.Functions.Fixpoint.html#866" class="Bound">y</a><a id="1476" class="Symbol">)</a> <a id="1478" href="Cubical.Functions.Fixpoint.html#870" class="Bound">q</a> <a id="1480" href="Cubical.Functions.Fixpoint.html#1432" class="Bound">j</a> <a id="1482" href="Cubical.Functions.Fixpoint.html#1430" class="Bound">i</a>
  <a id="1486" href="Cubical.Functions.Fixpoint.html#1486" class="Function">t</a> <a id="1488" class="Symbol">:</a> <a id="1490" href="Agda.Builtin.Cubical.Path.html#190" class="Postulate">PathP</a> <a id="1496" class="Symbol">(λ</a> <a id="1499" href="Cubical.Functions.Fixpoint.html#1499" class="Bound">i</a> <a id="1501" class="Symbol">→</a> <a id="1503" href="Cubical.Foundations.Prelude.html#1138" class="Function">cong</a> <a id="1508" href="Cubical.Functions.Fixpoint.html#848" class="Bound">f</a> <a id="1510" href="Cubical.Functions.Fixpoint.html#1342" class="Function">s</a> <a id="1512" href="Cubical.Functions.Fixpoint.html#1499" class="Bound">i</a> <a id="1514" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="1516" href="Cubical.Functions.Fixpoint.html#1342" class="Function">s</a> <a id="1518" href="Cubical.Functions.Fixpoint.html#1499" class="Bound">i</a><a id="1519" class="Symbol">)</a> <a id="1521" href="Cubical.Functions.Fixpoint.html#862" class="Bound">p</a> <a id="1523" href="Cubical.Functions.Fixpoint.html#870" class="Bound">q</a>
  <a id="1527" href="Cubical.Functions.Fixpoint.html#1486" class="Function">t</a> <a id="1529" class="Symbol">=</a> <a id="1531" href="Cubical.Foundations.Prelude.html#7449" class="Function">subst</a> <a id="1537" class="Symbol">(λ</a> <a id="1540" href="Cubical.Functions.Fixpoint.html#1540" class="Bound">kraus</a> <a id="1546" class="Symbol">→</a> <a id="1548" href="Agda.Builtin.Cubical.Path.html#190" class="Postulate">PathP</a> <a id="1554" class="Symbol">(λ</a> <a id="1557" href="Cubical.Functions.Fixpoint.html#1557" class="Bound">i</a> <a id="1559" class="Symbol">→</a> <a id="1561" href="Cubical.Functions.Fixpoint.html#1540" class="Bound">kraus</a> <a id="1567" href="Cubical.Functions.Fixpoint.html#1557" class="Bound">i</a> <a id="1569" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="1571" href="Cubical.Functions.Fixpoint.html#1342" class="Function">s</a> <a id="1573" href="Cubical.Functions.Fixpoint.html#1557" class="Bound">i</a><a id="1574" class="Symbol">)</a> <a id="1576" href="Cubical.Functions.Fixpoint.html#862" class="Bound">p</a> <a id="1578" href="Cubical.Functions.Fixpoint.html#870" class="Bound">q</a><a id="1579" class="Symbol">)</a> <a id="1581" class="Symbol">(</a><a id="1582" href="Cubical.Functions.Fixpoint.html#1105" class="Function">KrausInsight</a> <a id="1595" href="Cubical.Functions.Fixpoint.html#1342" class="Function">s</a><a id="1596" class="Symbol">)</a> <a id="1598" href="Cubical.Functions.Fixpoint.html#1384" class="Function">t&#39;</a>
